# Сравнение GC
|                  |                                  | Parallel Collector | CMS     | G1   |
|------------------|----------------------------------|--------------------|---------|------|
| Young Generation | Количество сборок                | 4                  | 10      | 64   |
|                  | Время на сборки, сек             | 1,9                | 5       | 3,8  |
| Old Generation   | Количество сборок                | 6                  | 56      | 8    |
|                  | Время на сборки, сек             | 8,1                | 158     | 8,2  |
| Xms Xmx 2Гб      | Время работы приложения, мин:сек | 3:04               | 4:56    | 5:24 |
|                  | Кол-во полных успешных           | 4                  | 6       | 7    |
|                  |  прохождений цикла               |                    |         |      |


Запуск проводился в новых сеансах работы IntelliJ IDEA, с предварительными сборками перед запусками для избежания 
погрешностей измерения в результате работы оптимизатора JIT. Для подстраховки, оптимизаций не ожидается, так как 
только создание и удаление объектов.

Моделируется процесс, в котором при каждой обработке в цикле увеличивается кол-во новых элементов.
Также очищается половина объектов, с постепенным уменьшением числа удаляемых элементов. 
Изменение кол-ва пропорционально номеру итерации цикла. 
При этом удаление происходит по принципу очереди: при каждом прохождении цикла удаляются первые элементы.
Применительно к работе GC это означает, что в начале работы программы будет доступно большее кол-во Young Generation, 
а после нескольких сборок мусора, объекты, доступные к удалению будут являться Old Generation.

При сравнении нам важны критерии: кол-во успешно обработанных итераций цикла, затраченное время на сборку мусора. 
Критично, чтобы приложение работало с минимальным хипом, например, если планируется эксплуатация в условиях 
ограниченных ресурсов виртуальных машин в компании или деплой в облаке.
При запуске с хипом 2Гб и ParallelGC приложение успевает отработать только 4 полных прохождения 
цикла, на 5 уже прерывается. 
Время работы составляет только порядка 3 минут, что значительно меньше, чем при других сборщиках. 
При этом время на сборку затрачено значительно меньше, чем в CMS. Следовательно, если бы требовалось обработать 
максимальный объем данных без ограничений в объеме хипа и скорости отклика, то параллельный сборщик мусора обеспечил бы 
подходящую скорость обработки.
Время работы приложения при CMS и G1 отличается незначительно, в обоих случаях порядка 5 минут. 
У G1 кол-во минорных сборок мусора намного превышает Parallel и CMS, 
за счет распределения нагрузки успевает освободить память для следующих итераций, 
таким образом приложение успевает выполнить больше бизнес логики, 7 итераций в сравнении с 6. 
Общее время, затраченное на сборку мусора G1 меньше CMS.

Таким образом, в данном приложении, с учетом заданных критериев больше подходит G1, обеспечивающий более эффективную 
обработку с меньшими временными затратами на сборку мусора в условиях ограниченного ресурса памяти. 


Дополнительно, в качестве эксперимента приложение было также запущено:
 - на 256Мб хипа - успевает обработать только часть первой итерации цикла, далее память переполняется.
 - на 10Гб хипа - при достижении 60% отведенной памяти тенденция меняется, темпы заполнения значительно уменьшаются, 
 вместо прироста в виде "лестницы" стабилизируется в подобие некой синусоиды. Пиковые значения очень медленно 
 увеличиваются, например, за 3 часа работы в пределах 7,5Гб. В среднем по 2 минорных сборки мусора 
 за итерацию цикла, суммарно ~за 0,5 сек.